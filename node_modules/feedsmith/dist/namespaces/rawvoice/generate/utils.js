import { generateCdataString, generateNumber, generatePlainString, generateRfc822Date, generateTextOrCdataString, generateYesNoBoolean, isObject, trimArray, trimObject } from "../../../common/utils.js";

//#region src/namespaces/rawvoice/generate/utils.ts
const generateRating = (rating) => {
	if (!isObject(rating)) return;
	return trimObject({
		...generateTextOrCdataString(rating.value),
		"@tv": generatePlainString(rating.tv),
		"@movie": generatePlainString(rating.movie)
	});
};
const generateLiveStream = (liveStream) => {
	if (!isObject(liveStream)) return;
	return trimObject({
		...generateTextOrCdataString(liveStream.url),
		"@schedule": generateRfc822Date(liveStream.schedule),
		"@duration": generatePlainString(liveStream.duration),
		"@type": generatePlainString(liveStream.type)
	});
};
const generatePoster = (poster) => {
	if (!isObject(poster)) return;
	return trimObject({ "@url": generatePlainString(poster.url) });
};
const generateAlternateEnclosure = (alternateEnclosure) => {
	if (!isObject(alternateEnclosure)) return;
	return trimObject({
		"@src": generatePlainString(alternateEnclosure.src),
		"@type": generatePlainString(alternateEnclosure.type),
		"@length": generateNumber(alternateEnclosure.length)
	});
};
const generateSubscribe = (subscribe) => {
	if (!isObject(subscribe)) return;
	const value = {};
	for (const key in subscribe) value[`@${key}`] = generatePlainString(subscribe[key]);
	return trimObject(value);
};
const generateMetamark = (metamark) => {
	if (!isObject(metamark)) return;
	return trimObject({
		...generateTextOrCdataString(metamark.value),
		"@type": generatePlainString(metamark.type),
		"@link": generatePlainString(metamark.link),
		"@position": generateNumber(metamark.position),
		"@duration": generateNumber(metamark.duration)
	});
};
const generateDonate = (donate) => {
	if (!isObject(donate)) return;
	return trimObject({
		...generateTextOrCdataString(donate.value),
		"@href": generatePlainString(donate.href)
	});
};
const generateItem = (item) => {
	if (!isObject(item)) return;
	return trimObject({
		"rawvoice:poster": generatePoster(item.poster),
		"rawvoice:isHd": generateYesNoBoolean(item.isHd),
		"rawvoice:embed": generateCdataString(item.embed),
		"rawvoice:webm": generateAlternateEnclosure(item.webm),
		"rawvoice:mp4": generateAlternateEnclosure(item.mp4),
		"rawvoice:metamark": trimArray(item.metamarks, generateMetamark)
	});
};
const generateFeed = (feed) => {
	if (!isObject(feed)) return;
	return trimObject({
		"rawvoice:rating": generateRating(feed.rating),
		"rawvoice:liveEmbed": generateCdataString(feed.liveEmbed),
		"rawvoice:flashLiveStream": generateLiveStream(feed.flashLiveStream),
		"rawvoice:httpLiveStream": generateLiveStream(feed.httpLiveStream),
		"rawvoice:shoutcastLiveStream": generateLiveStream(feed.shoutcastLiveStream),
		"rawvoice:liveStream": generateLiveStream(feed.liveStream),
		"rawvoice:location": generateCdataString(feed.location),
		"rawvoice:frequency": generateCdataString(feed.frequency),
		"rawvoice:mycast": generateYesNoBoolean(feed.mycast),
		"rawvoice:subscribe": generateSubscribe(feed.subscribe),
		"rawvoice:donate": generateDonate(feed.donate)
	});
};

//#endregion
export { generateFeed, generateItem };